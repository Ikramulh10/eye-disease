<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Eye Disease Detection Clinic Software</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&display=swap');

  /* Base reset and setup */
  *, *::before, *::after {
    box-sizing: border-box;
  }
  html, body {
    height: 100%;
    margin: 0;
    font-family: 'Montserrat', sans-serif;
    background: url('https://images.unsplash.com/photo-1524601021131-086a01cf78ae?auto=format&fit=crop&w=1470&q=80') no-repeat center center fixed;
    background-size: cover;
    color: #e0e6f0;
    display: flex;
    flex-direction: column;
    align-items: center;
    min-height: 100vh;
    overflow-x: hidden;
  }
  body::before {
    content: "";
    position: fixed;
    top: 0; left: 0;
    width: 100%; height: 100%;
    background: rgba(7, 15, 30, 0.75);
    z-index: -1;
  }

  header {
    width: 100%;
    padding: 1.5rem 2rem;
    background: rgba(20, 35, 61, 0.85);
    text-align: center;
    font-size: 2rem;
    font-weight: 700;
    color: #76b8ff;
    letter-spacing: 2px;
    box-shadow: 0 4px 8px rgba(0,0,0,0.6);
    z-index: 10;
  }

  nav {
    width: 100%;
    background: rgba(14, 26, 46, 0.90);
    display: flex;
    justify-content: center;
    gap: 1.5rem;
    padding: 0.8rem 0;
    box-shadow: 0 4px 8px rgba(0,0,0,0.5);
    user-select: none;
    z-index: 10;
  }

  nav button {
    background: transparent;
    border: none;
    color: #a8b9db;
    font-size: 1.1rem;
    padding: 0.7rem 1.8rem;
    cursor: pointer;
    border-radius: 40px;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 1.3px;
    transition: all 0.3s ease;
  }

  nav button.active,
  nav button:hover {
    background: linear-gradient(90deg, #80c1ff 0%, #3c7aff 100%);
    color: white;
    box-shadow: 0 7px 14px rgba(60,122,255,0.85);
    transform: scale(1.1);
    position: relative;
    z-index: 20;
  }

  main {
    flex-grow: 1;
    width: 90%;
    max-width: 960px;
    margin: 2rem 0 4rem;
    background: rgba(20, 35, 62, 0.9);
    border-radius: 20px;
    padding: 3rem 3rem 4rem 3rem;
    box-shadow: 0 16px 50px rgba(0,0,0,0.9);
    color: #c1cbdc;
    min-height: 580px;
    overflow-y: auto;
    position: relative;
    z-index: 10;
  }

  .content {
    display: none;
  }
  .content.active {
    display: block;
  }

  h2 {
    font-size: 2.4rem;
    margin-bottom: 1.5rem;
    color: #7bc4ff;
    text-align: center;
    text-shadow: 0 0 12px #4a90e2;
  }

  label {
    font-weight: 700;
    font-size: 1.2rem;
    margin-bottom: 1rem;
    display: block;
    color: #8ea7db;
  }

  input[type="file"],
  input[type="text"],
  input[type="password"],
  textarea {
    width: 100%;
    padding: 14px 18px;
    border-radius: 14px;
    border: none;
    font-size: 1.1rem;
    margin-bottom: 1.8rem;
    background-color: #2f4367;
    color: #d4e3ff;
    transition: background-color 0.3s ease;
    outline-offset: 3px;
    outline-color: #4a90e2;
  }

  input[type="file"] {
    cursor: pointer;
    font-weight: 700;
    background-color: #3c6efb;
  }
  input[type="file"]:hover {
    background-color: #2e57d6;
  }
  input::placeholder,
  textarea::placeholder {
    color: #7c9cf5;
  }
  input:focus, textarea:focus {
    background-color: #3f5db5;
  }

  button {
    padding: 16px 32px;
    background: linear-gradient(90deg, #3c7aff 0%, #80c1ff 100%);
    color: #f0f8ff;
    font-weight: 700;
    font-size: 1.35rem;
    border: none;
    border-radius: 50px;
    cursor: pointer;
    transition: all 0.3s ease;
    box-shadow: 0 10px 28px rgba(60,122,255,0.8);
    user-select: none;
  }
  button:hover {
    background: linear-gradient(90deg, #5f9aff 0%, #a0c9ff 100%);
    box-shadow: 0 14px 38px rgba(80,150,255,1);
    transform: scale(1.1);
  }

  #image-preview {
    max-width: 380px;
    max-height: 380px;
    margin: 2rem auto 1.5rem;
    border-radius: 28px;
    border: 3px solid #4a90e2;
    box-shadow: 0 0 20px #4a90e2;
    object-fit: contain;
    background-color: #192e58;
    display: none;
  }

  #prediction-result {
    font-size: 2rem;
    font-weight: 700;
    text-align: center;
    background: rgba(107, 186, 255, 0.18);
    padding: 1.3rem 3rem;
    border-radius: 28px;
    box-shadow: 0 0 20px rgba(107,186,255,0.9);
    margin: 0 auto;
    max-width: 500px;
    color: #59afff;
    text-shadow: 0 0 9px #2f79e0;
  }

  #login-container {
    background: rgba(19, 31, 54, 0.95);
    padding: 3.5rem 4rem;
    border-radius: 38px;
    box-shadow: 0 0 60px rgba(10, 24, 50, 1);
    width: 460px;
    text-align: center;
    margin-top: 10vh;
    z-index: 20;
  }

  .error {
    color: #ff6363;
    font-weight: 700;
    margin-bottom: 1.6rem;
    display: none;
    font-size: 1.15rem;
    text-shadow: 0 0 5px #9a0000;
  }

  nav {
    margin-top: 2rem;
  }

  main::-webkit-scrollbar {
    width: 8px;
  }
  main::-webkit-scrollbar-thumb {
    background-color: #4a7aff;
    border-radius: 10px;
  }

  #history-list {
    max-height: 320px;
    overflow-y: auto;
    list-style-type: decimal;
    padding-left: 1.6rem;
  }

  textarea {
    height: 110px;
    resize: vertical;
  }
</style>
</head>
<body>

<header>Eye Disease Detection Clinic Software</header>

<!-- Login Screen -->
<div id="login-container" role="main" aria-label="Login form">
  <h2>Clinic Login</h2>
  <div id="login-error" class="error" role="alert"></div>
  <input type="text" id="username" placeholder="Username" autocomplete="username" aria-required="true" />
  <input type="password" id="password" placeholder="Password" autocomplete="current-password" aria-required="true" />
  <button id="login-btn">Login</button>
</div>

<!-- Navigation & Content (hidden until login) -->
<nav id="nav-bar" style="display:none;">
  <button id="nav-home" class="active">Dashboard</button>
  <button id="nav-about">About Diseases</button>
  <button id="nav-history">Prediction History</button>
  <button id="nav-contact">Contact</button>
</nav>

<main id="main-content" style="display:none;">
  <section id="dashboard" class="content active">
    <h2>Eye Disease Detector</h2>
    <label for="image-upload">Upload Fundus Image:</label>
    <input type="file" id="image-upload" accept="image/*" />
    <img id="image-preview" alt="Fundus Preview" />
    <div id="prediction-result"></div>
  </section>

  <section id="about" class="content" style="display:none;">
    <h2>About Supported Eye Diseases</h2>
    <ul>
      <li><strong>Normal:</strong> Healthy retina without signs of disease.</li>
      <li><strong>Diabetes:</strong> Diabetic retinopathy causing blood vessel damage.</li>
      <li><strong>Glaucoma:</strong> Increased eye pressure damaging optic nerve.</li>
      <li><strong>Cataract:</strong> Clouding of the eye lens causing blurred vision.</li>
      <li><strong>Age-related Macular Degeneration:</strong> Deterioration of central retina.</li>
      <li><strong>Hypertensive Retinopathy:</strong> Retinal damage due to high blood pressure.</li>
      <li><strong>Myopia:</strong> Nearsightedness causing blurred distant vision.</li>
      <li><strong>Unclassified case:</strong> Cases not fitting specific categories.</li>
    </ul>
  </section>

  <section id="history" class="content" style="display:none;">
    <h2>Prediction History</h2>
    <ul id="history-list"><li>No predictions made yet.</li></ul>
    <button id="clear-history">Clear History</button>
  </section>

  <section id="contact" class="content" style="display:none;">
    <h2>Contact Us</h2>
    <p>If you have questions or need support, please reach out:</p>
    <p>Email: clinic@example.com</p>
    <p>Phone: +1-234-567-8900</p>
    <p>Address: 123 Health St, Medical City, Country</p>
    <h3>Send us a message</h3>
    <form id="contact-form">
      <input type="text" id="contact-name" placeholder="Your Name" required />
      <input type="text" id="contact-email" placeholder="Your Email" required />
      <textarea id="contact-message" placeholder="Your Message" required></textarea>
      <button type="submit">Send</button>
    </form>
    <div id="contact-success" style="color: #88ff88; margin-top: 1rem; display:none;">
      Thank you for your message! We will get back to you soon.
    </div>
  </section>
</main>

<script>
  const loginContainer = document.getElementById('login-container');
  const navBar = document.getElementById('nav-bar');
  const mainContent = document.getElementById('main-content');

  const navButtons = {
    home: document.getElementById('nav-home'),
    about: document.getElementById('nav-about'),
    history: document.getElementById('nav-history'),
    contact: document.getElementById('nav-contact')
  };
  const sections = {
    home: document.getElementById('dashboard'),
    about: document.getElementById('about'),
    history: document.getElementById('history'),
    contact: document.getElementById('contact')
  };

  const usernameInput = document.getElementById('username');
  const passwordInput = document.getElementById('password');
  const loginBtn = document.getElementById('login-btn');
  const loginError = document.getElementById('login-error');

  const imageUpload = document.getElementById('image-upload');
  const imagePreview = document.getElementById('image-preview');
  const predictionResult = document.getElementById('prediction-result');

  const historyList = document.getElementById('history-list');
  const clearHistoryBtn = document.getElementById('clear-history');

  const contactForm = document.getElementById('contact-form');
  const contactSuccess = document.getElementById('contact-success');

  const historyKey = 'predictionsHistory';

  function showSection(section) {
    Object.values(sections).forEach(s => s.style.display = 'none');
    sections[section].style.display = 'block';

    Object.values(navButtons).forEach(btn => btn.classList.remove('active'));
    navButtons[section].classList.add('active');
  }

  loginBtn.addEventListener('click', () => {
    loginError.style.display = 'none';
    const username = usernameInput.value.trim();
    const password = passwordInput.value.trim();

    if (!username || !password) {
      loginError.textContent = 'Please enter username and password';
      loginError.style.display = 'block';
      return;
    }

    if (username === 'clinicuser' && password === 'password123') {
      loginContainer.style.display = 'none';
      navBar.style.display = 'flex';
      mainContent.style.display = 'block';
      showSection('home');
      resetDashboard();
    } else {
      loginError.textContent = 'Invalid username or password';
      loginError.style.display = 'block';
    }
  });

  navButtons.home.onclick = () => showSection('home');
  navButtons.about.onclick = () => showSection('about');
  navButtons.history.onclick = () => {
    showSection('history');
    loadHistory();
  };
  navButtons.contact.onclick = () => showSection('contact');

  imageUpload.addEventListener('change', async () => {
    const file = imageUpload.files[0];
    if (!file) return;

    const reader = new FileReader();
    reader.onload = (e) => {
      imagePreview.src = e.target.result;
      imagePreview.style.display = 'block';
    };
    reader.readAsDataURL(file);

    predictionResult.textContent = 'Analyzing image...';

    const prediction = await sendImageToBackend(file);

    if (prediction) {
      predictionResult.textContent = `Predicted Disease: ${prediction.predicted_class}`;
      saveHistory(prediction.predicted_class);
    } else {
      predictionResult.textContent = 'Failed to get prediction. Please try again.';
    }
  });

  async function sendImageToBackend(file) {
    const formData = new FormData();
    formData.append('file', file);
    try {
      // Update backend URL here:
      const response = await fetch('https://eye-disease-detection-67jk.onrender.com/predict', {
        method: 'POST',
        body: formData
      });
      if (!response.ok) throw new Error('Prediction request failed');
      return await response.json();
    } catch (error) {
      console.error(error);
      return null;
    }
  }

  function saveHistory(disease) {
    const history = JSON.parse(localStorage.getItem(historyKey)) || [];
    const timestamp = new Date().toLocaleString();
    history.push({ disease, timestamp });
    localStorage.setItem(historyKey, JSON.stringify(history));
  }

  function loadHistory() {
    const history = JSON.parse(localStorage.getItem(historyKey)) || [];
    historyList.innerHTML = '';
    if (history.length === 0) {
      historyList.innerHTML = '<li>No predictions made yet.</li>';
      return;
    }
    history.forEach(item => {
      const li = document.createElement('li');
      li.textContent = `${item.timestamp} - ${item.disease}`;
      historyList.appendChild(li);
    });
  }

  clearHistoryBtn.onclick = () => {
    if (confirm('Clear all prediction history?')) {
      localStorage.removeItem(historyKey);
      loadHistory();
    }
  };

  contactForm.addEventListener('submit', (e) => {
    e.preventDefault();
    contactForm.reset();
    contactSuccess.style.display = 'block';
    setTimeout(() => { contactSuccess.style.display = 'none'; }, 5000);
  });

  function resetDashboard() {
    imagePreview.style.display = 'none';
    imagePreview.src = '';
    predictionResult.textContent = '';
    imageUpload.value = '';
  }
</script>

</body>
</html>
